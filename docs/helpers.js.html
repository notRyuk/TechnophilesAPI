<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>helpers.js - TechnophilesAPI</title>
    
    <meta name="description" content="The API made by TriColored Technophiles SIH team for easy handling of frond-end apps." />
    
        <meta name="keywords" content="SIH, API, Disaster Management, Node, express" />
        <meta name="keyword" content="SIH, API, Disaster Management, Node, express" />
    
    
    
    <meta property="og:title" content="TechnophilesAPI"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BlogObject.html">BlogObject</a><ul class='methods'><li data-type='method' style='display: none;'><a href="BlogObject.html#create">create</a></li><li data-type='method' style='display: none;'><a href="BlogObject.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="BlogObject.html#findBySimilarity">findBySimilarity</a></li><li data-type='method' style='display: none;'><a href="BlogObject.html#update">update</a></li></ul></li><li><a href="CollectionObject.html">CollectionObject</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CollectionObject.html#emailAlreadyExists">emailAlreadyExists</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#findById">findById</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#isEmailValid">isEmailValid</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#isPhoneValid">isPhoneValid</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#phoneAlreadyExists">phoneAlreadyExists</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#usernameAlreadyExists">usernameAlreadyExists</a></li><li data-type='method' style='display: none;'><a href="CollectionObject.html#verify">verify</a></li></ul></li><li><a href="NGOObject.html">NGOObject</a><ul class='methods'><li data-type='method' style='display: none;'><a href="NGOObject.html#create">create</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#getPinCodeInfo">getPinCodeInfo</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateAddress">updateAddress</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateCloseTime">updateCloseTime</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateDays">updateDays</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateEmail">updateEmail</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateLatitude">updateLatitude</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateLongitude">updateLongitude</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateName">updateName</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updatePhone">updatePhone</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#updateStartTime">updateStartTime</a></li><li data-type='method' style='display: none;'><a href="NGOObject.html#verifyNGO">verifyNGO</a></li></ul></li><li><a href="UserObject.html">UserObject</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UserObject.html#updateEmail">updateEmail</a></li><li data-type='method' style='display: none;'><a href="UserObject.html#updateEncryption">updateEncryption</a></li><li data-type='method' style='display: none;'><a href="UserObject.html#updateName">updateName</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="BlogRoutes.html">BlogRoutes</a></li><li><a href="NGORoutes.html">NGORoutes</a></li><li><a href="UserRoutes.html">UserRoutes</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AddressOfNGO">AddressOfNGO</a></li><li><a href="global.html#Blog">Blog</a></li><li><a href="global.html#Error">Error</a></li><li><a href="global.html#LocationOfNGO">LocationOfNGO</a></li><li><a href="global.html#NameOfUser">NameOfUser</a></li><li><a href="global.html#NGO">NGO</a></li><li><a href="global.html#searchBlog">searchBlog</a></li><li><a href="global.html#TimingsOfNGO">TimingsOfNGO</a></li><li><a href="global.html#User">User</a></li><li><a href="global.html#UserBlogSchema">UserBlogSchema</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">helpers.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { user } from "./mongoose.js";
import { promisify } from 'util';
import { exec as exec1} from 'child_process';
const exec = promisify(exec1)


const lowerCase = (() => {
    var i = 97
    var letters = ""
    for(var k=0; k&lt;26; k++) {
        letters += String.fromCharCode(i+k)
    }
    return letters
})()

const createLowerCaseObject = () => {
    var obj = {} 
    for(var a of lowerCase) {
        obj[a] = []
    }
    return obj
}

/**
 * Returns the queries with their start and end index if found in the text
 * @param {String} query A string consisting of words to be entered as the query
 * @param {String} text The text within which the queries are to be searched
 * @returns String
 */
const searchBlog = async(query, text) => {
    var out = ""
    const child = await exec(`java search "${query}" "${text}"`)
    if(child.stdout) {
        out += child.stdout
    }
    if(child.stderr) {
        out += `stderr: ${child.stderr}`
    }
    return out
}

class Tokenizer {
    /**
     * Tokenize the text into a token for multiple other purposes
     * @param {String} text The text that has to be tokenized
     * @returns String
     */
    encrypt(text) {
        var year = new Date().getFullYear()
        var key = Math.floor((text.charCodeAt(0)*text.charCodeAt(1)+16)/year)
        var text = this.shuffle(text.split("").map((e, i) => (e.charCodeAt(0)+key).toString().padStart(3, "0")+(i+key).toString().padStart(2, "0"))).join("")
        year = year.toString().split("").map((e, i) => (i===0)?e.charCodeAt(0)-key:e.charCodeAt(0)+key).join("")
        text += ":"+year+key.toString()+"-"+key.toString().length
        return text
    }

    /**
     * Decrypts the given token into string
     * @param {String} token The token that is to be converted back into the text
     * @returns String
     */
    decrypt(token) {
        var tokens = token.split("-")
        var keyLength = Number(tokens[tokens.length-1])
        var mainTokens = tokens[0].split(":")
        var temp = mainTokens[1].split("").reverse()
        var key = 0
        var i = 0
        while(i&lt;keyLength) {
            key += Number(temp.splice(0, 1))*(10**i)
            i++
        }
        key = Number(key)
        var keys = []
        var temp1 = mainTokens[0].split("")
        for(var i=0; i&lt;mainTokens[0].length/5; i++) {
            temp = []
            for(var k=0; k&lt;5; k++) {
                temp.push(temp1.splice(0, 1)[0])
            }
            keys.push(temp)
        }
        var values = Array(keys.length).fill("")
        for(var k of keys) {
            var ascii = 0
            var index = 0
            i = 3
            while(i--) {
                ascii += (+k.splice(0, 1))*(10**i)
            }
            i = 2
            while(i--) {
                index += (+k.splice(0, 1))*(10**i)
            }
            values[index-key] = String.fromCharCode(ascii-key)
        }
        return values.join("")
    }

    /**
     * Returns the shuffled array
     * @param {String[]} array The strings that have to be shuffled
     * @returns String[]
     */
    shuffle(array) {
        var m = array.length, t, i
        while(m) {
            i = Math.floor(Math.random()*m--)
            t = array[m]
            array[m] = array[i]
            array[i] = t
        }
        return array
    }
}

class Globals {
    constructor() {
        setImmediate(() => {
            var userObject = createLowerCaseObject()
            var users = []
            user.find({}, (err, __users) => {
                if(err) return err
                if(__users) {
                    users = __users
                    __users = __users.map(__user => __user._id)
                    for(var __user of __users) {
                        delete __user.__v
                        userObject[__user[0]].push(__user)
                    }
                }
            })
            this.users = userObject
            this.user_col = users
        })
    }

    // updateUsers = () => {
    //     var userObject = createLowerCaseObject()
    //     var users = []
    //     user.find({}, (err, __users) => {
    //         if(err) return err
    //         if(__users) {
    //             console.log("__users", __users)
    //             users.push(__users)
    //             __users = __users.map(__user => __user._id)
    //             // console.log(__users)
    //             for(var __user of __users) {
    //                 delete __user.__v
    //                 userObject[__user[0]].push(__user)
    //             }
    //             // this.users = userObject
    //             // this.user_col = users
    //             // console.log(this.users)
    //             cache.set("users", userObject)
    //             cache.set("user_col", users)
    //             console.log("users", userObject)
    //             console.log("user_col", users)
    //             return new Globals(userObject, users)
    //         }
    //     })
    // }

    addNewUser(username) {
        this.users[username[0]].push(username)
    }

    updateOldUsername(oldUsername, newUsername) {
        this.users[oldUsername[0]].splice(this.users[oldUsername[0]].indexOf(oldUsername), 1)
        this.users[newUsername[0]].push(newUsername)
    }

    deleteUsername(username) {
        this.users[username[0]].splice(this.users[username[0]].indexOf(username),1)
    }

    addNewUserToCol(userObject) {
        this.user_col.push(userObject)
    }

    updateUserInCol(id, userObject) {
        this.deleteUserFromCol(id)
        this.user_col.push(userObject)
    }

    deleteUserFromCol(id) {
        var __id  = this.users[id[0]]
        if(!__id.includes(id)) {
            return {
                status: 404,
                comment: "BadRequest! No such user in database!"
            }
        }
        this.user_col.splice(this.user_col.map(e => e._id).indexOf(id), 1)
    }
}

const stateList = [
    "Andhra Pradesh",
    "Arunachal Pradesh",
    "Assam",
    "Bihar",
    "Chhattisgarh",
    "Goa",
    "Gujarat",
    "Haryana",
    "Himachal Pradesh",
    "Jammu and Kashmir",
    "Jharkhand",
    "Karnataka",
    "Kerala",
    "Madhya Pradesh",
    "Maharashtra",
    "Manipur",
    "Meghalaya",
    "Mizoram",
    "Nagaland",
    "Odisha",
    "Punjab",
    "Rajasthan",
    "Sikkim",
    "Tamil Nadu",
    "Telangana",
    "Tripura",
    "Uttarakhand",
    "Uttar Pradesh",
    "West Bengal",
    "Andaman and Nicobar Islands",
    "Chandigarh",
    "Dadra and Nagar Haveli",
    "Daman and Diu",
    "Delhi",
    "Lakshadweep",
    "Puducherry"
]

const __globals = new Globals()
const tokenizer = new Tokenizer()

export {
    lowerCase,
    createLowerCaseObject,
    searchBlog,
    __globals,
    stateList,
    tokenizer
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Fri Aug 12 2022 19:37:27 GMT+0530 (India Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


    <link type="text/css" rel="stylesheet" href="./style.css">
    
</body>
</html>
